<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>DTX | Script Hub Key Generator</title>
<style>
body {
    background: #0f0f0f;
    color: #fff;
    font-family: Arial, sans-serif;
    text-align: center;
    padding-top: 80px;
}
h1 { font-size: 36px; margin-bottom: 10px; }
p { font-size: 18px; margin-bottom: 30px; }
button {
    padding: 15px 30px;
    font-size: 18px;
    cursor: pointer;
    border-radius: 10px;
    border: none;
    background-color: #1e90ff;
    color: white;
    transition: 0.2s;
}
button:hover { background-color: #0f6fc0; }
input {
    width: 80%;
    padding: 12px;
    font-size: 16px;
    margin-top: 20px;
    text-align: center;
    border-radius: 6px;
    border: none;
}
#countdown {
    margin-top: 20px;
    font-size: 16px;
    color: #ffcc00;
}
.container {
    max-width: 500px;
    margin: auto;
}
.social-btn {
    display: inline-block;
    margin: 5px;
    padding: 10px 20px;
    background-color: #1e90ff;
    color: white;
    text-decoration: none;
    border-radius: 8px;
    transition: 0.2s;
}
.social-btn:hover { background-color: #0f6fc0; }
</style>
</head>
<body>
<div class="container">
<h1>DTX | Script Hub</h1>
<p>Click the button to get your 30-minute key for the Script Hub</p>
<button onclick="generateKey()">Generate Key</button>
<br><br>
<input id="key" readonly placeholder="Your key will appear here">
<button onclick="copyKey()">Copy Key</button>
<div id="countdown"></div>

<!-- Social Links -->
<div id="social" style="margin-top:30px;">
  <p>Follow us on social media:</p>
  <a href="https://discord.gg/xKMg3JsTTc" target="_blank" class="social-btn">Discord</a>
  <a href="https://youtube.com/@dtxhub" target="_blank" class="social-btn">Youtube</a>
</div>
</div>

<script>
let keyTimestamp = null;

function generateKey() {
    const lastKeyTime = localStorage.getItem('lastKeyTime');
    const now = Date.now();

    // Prüfen, ob schon ein Key in dieser Sitzung generiert wurde
    if (sessionStorage.getItem('keyGenerated')) {
        alert("You have already generated a key during this visit!");
        return;
    }

    // Prüfen, ob 30 Minuten vergangen sind
    if (lastKeyTime && now - lastKeyTime < 30*60*1000) {
        const remaining = 30*60*1000 - (now - lastKeyTime);
        const minutes = Math.floor(remaining / (1000*60));
        const seconds = Math.floor((remaining % (1000*60)) / 1000);
        alert(`You can generate a new key every 30 minutes.\nTime left: ${minutes}m ${seconds}s`);
        return;
    }

    // Key generieren
    const timestamp = Math.floor(Date.now() / 1000);
    const random = crypto.randomUUID();
    const key = `DTX_${timestamp}_${random}`;
    document.getElementById("key").value = key;

    // Timestamp speichern
    localStorage.setItem('lastKeyTime', now);
    sessionStorage.setItem('keyGenerated', 'true');

    keyTimestamp = now;
    updateCountdown();
}

// Copy Key
function copyKey() {
    const keyInput = document.getElementById("key");
    keyInput.select();
    keyInput.setSelectionRange(0, 99999);
    navigator.clipboard.writeText(keyInput.value);
    alert("Key copied!");
}

// Countdown
function updateCountdown() {
    const lastKeyTime = localStorage.getItem('lastKeyTime');
    if (!lastKeyTime) return;
    const now = Date.now();
    const diff = 30*60*1000 - (now - lastKeyTime);
    if (diff <= 0) {
        document.getElementById("countdown").innerText = "";
        return;
    }
    const minutes = Math.floor(diff / (1000*60));
    const seconds = Math.floor((diff % (1000*60)) / 1000);
    document.getElementById("countdown").innerText = `Next key available in: ${minutes}m ${seconds}s`;
    setTimeout(updateCountdown, 1000);
}

// Start countdown on page load
window.onload = updateCountdown;
</script>
</body>
</html>
